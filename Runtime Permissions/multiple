 
 
 private boolean checkAndRequestRuntimePermission() {
        boolean allPermissionGranted = false;
        int readExternalStorage = ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE);
        int writeExternalStorage = ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE);
        int accessFineLocation = ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION);
        int camera = ContextCompat.checkSelfPermission(this, Manifest.permission.CAMERA);

        List<String> requestPermissionList = new ArrayList<>();

        if (readExternalStorage != PackageManager.PERMISSION_GRANTED) {
            requestPermissionList.add(Manifest.permission.READ_EXTERNAL_STORAGE);
        }
        if (writeExternalStorage != PackageManager.PERMISSION_GRANTED) {
            requestPermissionList.add(Manifest.permission.WRITE_EXTERNAL_STORAGE);
        }
        if (accessFineLocation != PackageManager.PERMISSION_GRANTED) {
            requestPermissionList.add(Manifest.permission.ACCESS_FINE_LOCATION);
        }
        if (camera != PackageManager.PERMISSION_GRANTED) {
            requestPermissionList.add(Manifest.permission.CAMERA);
        }

        if (!requestPermissionList.isEmpty()) {
            ActivityCompat.requestPermissions(this, requestPermissionList.toArray(new String[0]), REQUEST_MULTIPLE_PERMISSIONS);

        }else {
            allPermissionGranted = true;
        }

        return allPermissionGranted;

    }


    

    @Override
    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);


        if (requestCode == REQUEST_MULTIPLE_PERMISSIONS) {

            for (int i=0; i<grantResults.length; i++){
                switch (permissions[i]){
                    case Manifest.permission.READ_EXTERNAL_STORAGE:
                    case Manifest.permission.ACCESS_FINE_LOCATION:
                    case Manifest.permission.WRITE_EXTERNAL_STORAGE:
                    case Manifest.permission.CAMERA:
                        if (grantResults[i] == PackageManager.PERMISSION_GRANTED){
                            Log.e("TAG",permissions[i] + " granted");
                            Toast.makeText(this, permissions[0] + " granted", Toast.LENGTH_SHORT).show();
                        }else {
                            Log.e("TAG",permissions[i] + " deny");
                            Toast.makeText(this, permissions[0] + " deny", Toast.LENGTH_SHORT).show();
                        }
                        break;

                }


            }

           /* for (int i=0; i<grantResults.length; i++){
                if (grantResults[i] == PackageManager.PERMISSION_GRANTED){
                    Log.e("TAG",permissions[i] + " granted");
                    Toast.makeText(this, permissions[0] + " granted", Toast.LENGTH_SHORT).show();
                }else {
                    Log.e("TAG",permissions[i] + " deny");
                }
           }*/
//            if (grantResults[0] == PackageManager.PERMISSION_GRANTED) {
//                Log.e("TAG", permissions[0] + " granted");
//            } else {
//                Log.e("TAG", permissions[0] + " deny");
//            }
//
      }
    }